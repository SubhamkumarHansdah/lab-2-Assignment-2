#include <iostream>
using namespace std;

//Defining the basic structure of a node.
struct node{
	int data;
	node *next;
};

//Creating a linked list class
class linkedList{
private:
	node *head, *tail;
public:
	//Constructor that sets both head and tail to NULL.
	linkedList() {
		head = NULL;
		tail = NULL;
	}
	//Defining functions to act on the linked list.
	void Insert(int value);
	void InsertAt(int pos, int value);
	void Delete();
	void DeleteAt(int pos);
	int countItems();
	void display();
};

//Function to count the number of items in the linked list
int linkedList::countItems() {
	if (head == NULL) {
		return 0;
	}
	else {
		node *temp;
		temp = head;
		int count = 0;
		while (temp != NULL) {
			temp = temp->next;
			count++;
		}
		return count;
	}
}

//Function to insert element at the end
void linkedList::Insert(int value) {
	node *temp = new node;
	temp->data = value;
	temp->next = NULL;
	//If the linked list is empty, the new node becomes both the head and the tail
	if (head == NULL) {
		head = temp;
		tail = temp;
	}
	else {
		//Adding the new node to the end of the linked list
		tail->next = temp;
		//Changing the tail to the new last element
		tail = temp;
	}
}

//Function to delete element from the end
void linkedList::Delete() {
	//When the linked list is empty
	if (head == NULL) {
		cout << "The linked list is empty and has no elements to delete." << endl;
	}
	//When there's only one element in the linked list
	else if (countItems() == 1) {
		head = NULL;
		tail = NULL;
	}
	//For all other cases
	else {
		node *temp = tail;
		//We set tail to head
		tail = head;
		//And then move the tail to the second last element of the linked list
		while (tail->next != temp) {
			tail = tail->next;
		}
		tail->next = NULL;
		delete temp;
	}
}

//Function to insert element at a specific position
void linkedList::InsertAt(int pos, int value) {
	node *preceeding, *succeeding;
	node *temp = new node;
	temp->data = value;
	temp->next = NULL;
	succeeding = head;
	preceeding = NULL;
	//If the linked list is empty, we add value as the first element.
	if (head == NULL) {
		Insert(value);
		cout << "The linked list is empty. " << value << " has been added as the first element.\n";
	}
	//When the element needs to be added at the first position...
	else if (pos == 1) {
		temp->next = head;
		head = temp;
	}
	//For all other cases...
	else {
		//A loop that brings the two pointers preceeding and succeeding to the required positions
		for (int i = 1; i < pos; i++) {
			preceeding = succeeding;
			succeeding = succeeding->next;
		}
		if (preceeding == NULL) {
			cout << "The linked list doesn't have that many elements. " << value << " has been added at the end of the list.\n";
			Insert(value);
		}
		else {
			//Create a link from previous to temp
			preceeding->next = temp;
			//and then from temp to the next, therefore introducing temp in between the two.
			temp->next = succeeding;
		}
	}
}

//Function to display the elements of the linked list
void linkedList::display() {
	node *temp;
	temp = head;
	//When the linked list has no elements
	if (head == NULL) {
		cout << "The linked list has no elements.\n";
	}
	//When the linked list is not empty
	else {
		while (temp != NULL) {
			//Display the data stored in the current element
			cout << temp->data << " --> ";
			//and then move to the next one.
			temp = temp->next;
		}
		cout << "NULL" << endl;
	}
}

//Function to delete the element at a specific place
void linkedList::DeleteAt(int pos) {
	//Create three pointers
	node *preceeding, *succeeding, *current;
	succeeding = head;
	preceeding = NULL;
	current = NULL;
	//When the linked list is empty
	if (head == NULL) {
		cout << "The linked list is empty and has no elements to delete." << endl;
	}
	
	else if (countItems() < pos) {
		cout << "The linked list has no element in the position " << pos << "." << endl;
	}
	//When the first element is to be deleted
	else if (pos == 1) {
		head = head->next;
		delete succeeding;
	}
	//For the rest cases
	else {
		//We bring all three to the required positions, in which 'current' points to the node we want to delete
		for (int i = 1; i <= pos; i++) {
			preceeding = current;
			current = succeeding;
			succeeding = succeeding->next;
		}
		preceeding->next = succeeding;
		current->next = NULL;
		delete current;
	}
}

int main() {
	//And now what ever you want:)
	linkedList firstList;
	firstList.Insert(7);
	firstList.Insert(9);
	firstList.Insert(6);
	firstList.Insert(5);
	firstList.display();
	
	firstList.DeleteAt(1);
	firstList.display();
	cout << endl;
	return 0;
}
